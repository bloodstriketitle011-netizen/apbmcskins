<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Collectible Token Checkout ‚Äî Hex Wing Fix</title>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background-color: black;
    color: #fff;
    overflow-x: hidden;
  }
  .side-stripe { position: fixed; top: 0; width: 50px; height: 100%; background: #ffc107; z-index: -1; }
  .left-stripe { left: 0; }
  .right-stripe { right: 0; }
  .container { max-width: 600px; margin: 50px auto; background: #1a1a1a; padding: 30px; border-radius: 15px; box-shadow: 0 0 20px rgba(255,255,0,0.5); text-align: center; position: relative; }
  h1 { color: #ffc107; margin-bottom: 20px; }
  .product-img { width: 150px; border-radius: 15px; margin-bottom: 20px; }
  .price { font-size: 24px; font-weight: bold; color: #ffd700; margin: 15px 0; }
  button { background: #ffc107; color: black; font-size: 20px; border: none; padding: 15px 30px; border-radius: 10px; cursor: pointer; transition: transform 0.2s; margin: 10px; }
  button:hover { background: #e6a600; transform: scale(1.05); }
  .footer { text-align: center; font-size: 14px; color: #ccc; margin-top: 20px; }
  .bee { position: absolute; top: -60px; left: calc(50% - 60px); width: 140px; height: 80px; pointer-events: none; }
  .bee-body { position: absolute; left: 70px; top: 15px; width: 48px; height: 48px; background: black; border-radius: 50%; box-shadow: inset 0 0 0 6px #000; z-index: 2; }
  .bee-body::after { content: ""; position: absolute; left: 0; right: 0; top: 18px; height: 12px; background: #ffc107; border-radius: 6px; }
  .wing { position: absolute; top: 6px; left: -10px; width: 110px; height: 68px; z-index: 1; pointer-events: none; }
  .hex { position: absolute; width: 14px; height: 14px; clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%); box-shadow: 0 0 4px rgba(0,0,0,0.35); }
  .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center; visibility: hidden; z-index: 10; }
  .modal.active { visibility: visible; }
  .modal-content { background: black; color: #ffc107; border: 2px solid #ffc107; box-shadow: 0 0 15px #ffc107; padding: 20px; border-radius: 12px; text-align: center; width: 320px; }
  .loading-bar { width: 0; height: 15px; background: #ffc107; border-radius: 8px; margin: 15px auto; transition: width 2s linear; }
  .barcode { margin: 15px auto; width: 220px; height: 60px; display: flex; justify-content: center; align-items: center; background: white; flex-direction: column; }
  #beeBalance { position: fixed; top: 20px; right: 20px; background: #ffc107; color: black; padding: 10px 15px; border-radius: 25px; font-weight: bold; cursor: pointer; display: flex; align-items: center; z-index: 20; }
  #beeTooltip { position: fixed; top: 60px; right: 20px; background: #222; color: #ffc107; padding: 10px 15px; border-radius: 12px; display: none; font-size: 14px; z-index: 21; width: 200px; text-align: center; }
  select { padding: 10px; font-size: 18px; border-radius: 8px; margin-bottom: 15px; }
</style>
</head>
<body>
<div class="side-stripe left-stripe"></div>
<div class="side-stripe right-stripe"></div>

<div class="container">
  <div class="bee">
    <div class="wing" id="wing"></div>
    <div class="bee-body"></div>
  </div>

  <h1>Pre-Order Your Collectible Token</h1>
  <img src="token.png" alt="Collectible Token" class="product-img">
  <p>Be the first to own this exclusive collectible token! Limited edition, golden, and chaos-packed.</p>
  
  <select id="itemSelect">
    <option value="" disabled selected>Select Item</option>
    <option value="Brody-AP Bren|0.99">Brody-AP Bren ‚Äî $0.99</option>
    <option value="Paquito-FMVP|0.99">Paquito-FMVP ‚Äî $0.99</option>
    <option value="Bundle|1.49">Bundle ‚Äî $1.49</option>
  </select>
  <div class="price" id="itemPrice">$0.00</div>
  <button id="preorderBtn">Pre-Order Now</button>
</div>

<div id="beeBalance">üçØ <span id="beeCoins">15</span> BC</div>
<div id="beeTooltip">Used to buy items. 3 BC = $1.</div>
<div class="footer">&copy; 2025 ChaosCollectibles Co. All rights reserved.</div>

<!-- Confirm Modal -->
<div class="modal" id="confirmModal">
  <div class="modal-content">
    <h2>Confirm Order?</h2>
    <p id="confirmText"></p>
    <button id="yesConfirm">Yes</button>
    <button onclick="closeModal('confirmModal')">Cancel</button>
  </div>
</div>

<!-- Payment Modal -->
<div class="modal" id="paymentModal">
  <div class="modal-content">
    <h2>Select Payment</h2>
    <button onclick="startPayment('credit')">Credit/Debit Card</button>
    <button onclick="startPayment('gcash')">GCash</button>
    <button onclick="startPayment('paymaya')">PayMaya</button>
    <button onclick="startPayment('bdo')">BDO Bank</button>
    <button onclick="startPayment('uni')">UniBank</button>
    <button onclick="startPayment('7eleven')">7-Eleven</button>
    <button onclick="startPayment('beecoin')">BeeCoins üêù</button>
  </div>
</div>

<!-- Processing Modal -->
<div class="modal" id="processingModal">
  <div class="modal-content">
    <h2>Processing Payment...</h2>
    <div class="loading-bar" id="loadingBar"></div>
  </div>
</div>

<!-- Receipt Modal -->
<div class="modal" id="receiptModal">
  <div class="modal-content">
    <h2>Receipt</h2>
    <p>Item: <span id="receiptItem"></span></p>
    <p>Price: $<span id="receiptPrice"></span></p>
    <p>Transaction ID: <span id="txnId"></span></p>
    <div class="barcode"></div>
    <button onclick="closeModal('receiptModal')">Done</button>
  </div>
</div>

<script>
const wing = document.getElementById('wing');
const wingW = 110, wingH = 68, hexW = 14, hexH = 14;
const stepX = hexW*0.82, stepY = hexH*0.7;
const colors = ['#ffc107','#ff4d4d','#4dff4d','#4da6ff','#ff7af6','#ffa64d'];
const cx = wingW*0.58, cy = wingH*0.52, rx = wingW*0.60, ry = wingH*0.48;
const ang = -18 * Math.PI / 180;
function insideRotatedEllipse(x,y){const c=Math.cos(-ang),s=Math.sin(-ang);const dx=x-cx,dy=y-cy;const rxp=dx*c-dy*s,ryp=dx*s+dy*c;return (rxp*rxp)/(rx*rx)+(ryp*ryp)/(ry*ry)<=1;}
for(let row=0;row<Math.ceil(wingH/stepY)+2;row++){for(let col=0;col<Math.ceil(wingW/stepX)+2;col++){const offset=(row%2)?stepX/2:0;const x=col*stepX+offset,y=row*stepY,cxHex=x+hexW/2,cyHex=y+hexH/2;if(cxHex>=0&&cxHex<=wingW&&cyHex>=0&&cyHex<=wingH&&insideRotatedEllipse(cxHex,cyHex)){const hex=document.createElement('div');hex.className='hex';hex.style.left=x+'px';hex.style.top=y+'px';hex.style.background=colors[(row*7+col*11)%colors.length];wing.appendChild(hex);}}}

let beeCoins=15;
const beeBalance=document.getElementById('beeBalance');
const beeCoinSpan=document.getElementById('beeCoins');
const beeTooltip=document.getElementById('beeTooltip');
beeBalance.addEventListener('click',()=>{beeTooltip.style.display=beeTooltip.style.display==='none'?'block':'none';});

const itemSelect=document.getElementById('itemSelect');
const itemPrice=document.getElementById('itemPrice');
let selectedItem='', selectedPrice=0;

itemSelect.addEventListener('change',()=>{
  const val=itemSelect.value.split('|');
  selectedItem=val[0]; selectedPrice=parseFloat(val[1]);
  itemPrice.textContent=`$${selectedPrice.toFixed(2)}`;
});

document.getElementById('preorderBtn').addEventListener('click',()=>{
  if(!selectedItem){ alert('Select an item first!'); return; }
  document.getElementById('confirmText').textContent=`Item: ${selectedItem} ‚Äî $${selectedPrice.toFixed(2)}`;
  document.getElementById('confirmModal').classList.add('active');
});

document.getElementById('yesConfirm').addEventListener('click',()=>{
  closeModal('confirmModal');
  document.getElementById('paymentModal').classList.add('active');
});

function startPayment(method){
  closeModal('paymentModal');
  document.getElementById('processingModal').classList.add('active');
  const loadingBar=document.getElementById('loadingBar');
  loadingBar.style.width='0';
  requestAnimationFrame(()=>{loadingBar.style.width='100%';});
  setTimeout(()=>{
    closeModal('processingModal');
    if(method==='beecoin'){
      const costBC=Math.ceil(selectedPrice*3);
      if(beeCoins>=costBC){ beeCoins-=costBC; beeCoinSpan.textContent=beeCoins; alert('Paid using BeeCoins!'); } else { alert('Not enough BeeCoins!'); return; }
    }else{ alert(`Paid using ${method.toUpperCase()}!`); }
    const transactionID='BZZ-'+Math.random().toString(36).slice(2,10).toUpperCase();
    document.getElementById('txnId').textContent=transactionID;
    document.getElementById('receiptItem').textContent=selectedItem;
    document.getElementById('receiptPrice').textContent=selectedPrice.toFixed(2);

    const now=new Date();
    const utc8=new Date(now.getTime()+(8*60*60*1000));
    const formattedTime=utc8.toISOString().replace('T',' ').split('.')[0]+' UTC+8';

    const barcodeContainer = receiptModal.querySelector('.barcode');
    barcodeContainer.innerHTML = '';

    const svgNS = "http://www.w3.org/2000/svg";
    const svg = document.createElementNS(svgNS, "svg");
    svg.setAttribute("width", "220");
    svg.setAttribute("height", "60");

    const data = transactionID + "|$1.99";
    const totalWidth = 220;
    const numLines = data.length * 5;
    const lineWidth = totalWidth / numLines;

    for (let i = 0; i < numLines; i++) {
      const rect = document.createElementNS(svgNS, "rect");
      rect.setAttribute("x", i * lineWidth);
      rect.setAttribute("y", 0);
      rect.setAttribute("width", lineWidth * (Math.random() * 0.8 + 0.2));
      rect.setAttribute("height", 60);
      rect.setAttribute("fill", "black");
      svg.appendChild(rect);
    }

    barcodeContainer.appendChild(svg);

    const label = document.createElement('div');
    label.style.color = '#000';
    label.style.fontSize = '12px';
    label.style.textAlign = 'center';
    label.style.marginTop = '2px';

    let methodName = method === '7eleven' ? '7-Eleven' :
                     method === 'bdo' ? 'BDO Bank' :
                     method === 'uni' ? 'UniBank' :
                     method === 'beecoin' ? 'BeeCoins üêù' : method.toUpperCase();

    label.innerHTML = `${transactionID} | $1.99<br>Payment Method: ${methodName}<br>Time: ${formattedTime}`;
    barcodeContainer.appendChild(label);

    receiptModal.classList.add('active');
  }, 2300);
}

function closeModal(id) {
  document.getElementById(id).classList.remove('active');
}
</script>
</body>
</html>